{% extends "base_fullscreen.html" %}
{% load widget_tweaks %}

{% block content %}
<div class="bg-gray-50 min-h-screen py-12 px-4">
    <div class="max-w-3xl mx-auto">
        
        <!-- Header Simple -->
        <div class="bg-white rounded-lg shadow-md border border-gray-200 mb-8 p-8">
            <div class="text-center">
                <h1 class="text-3xl font-bold text-gray-800 mb-3">Encuesta de Evaluación</h1>
                <p class="text-lg text-gray-600">Seminario Web: "{{ constancia.curso.nombre }}"</p>
            </div>
            
            <div class="mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200">
                <div class="flex items-start space-x-3">
                    <svg class="w-6 h-6 text-blue-600 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                    <div>
                        <p class="text-gray-700 mb-1"><strong>Participante:</strong> {{ constancia.participante.nombre_completo }}</p>
                        <p class="text-gray-700"><strong>Correo Electrónico:</strong> {{ constancia.participante.email }}</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Formulario -->
        <div class="bg-white rounded-lg shadow-md border border-gray-200 p-8">
            <form method="post">
                {% csrf_token %}
                
                <div class="space-y-10">
                    {% for field in form %}
                    <div class="pb-6 {% if not forloop.last %}border-b border-gray-100{% endif %}">
                        <!-- Etiqueta de la pregunta -->
                        <label class="block text-lg font-semibold text-gray-800 mb-4 leading-relaxed">
                            {{ field.label }}
                        </label>
                        
                        {% if field.help_text %}
                            <p class="text-gray-500 text-sm mb-4">{{ field.help_text|safe }}</p>
                        {% endif %}
                        
                        <!-- Campo -->
                        <div class="mt-3">
                            {% if field.field.widget.input_type == 'checkbox' %}
                                <div class="p-4 border border-gray-200 rounded-lg bg-gray-50">
                                    <label class="flex items-center space-x-3 cursor-pointer">
                                        {{ field|add_class:"h-5 w-5 rounded border-gray-300 text-empresa-green focus:ring-empresa-green" }}
                                        <span class="text-gray-700">Sí, me gustaría recibir información adicional</span>
                                    </label>
                                </div>
                                
                            {% elif field.field.widget.input_type == 'radio' %}
                                <div class="space-y-3">
                                    {% for choice in field %}
                                        {% if choice.choice_label != "------" and choice.choice_label != "---------" and choice.choice_label != "" and choice.choice_label != "-" %}
                                            <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors duration-200">
                                                <input type="radio" 
                                                       name="{{ field.name }}" 
                                                       value="{{ choice.choice_value }}" 
                                                       {% if choice.choice_value == field.value %}checked{% endif %}
                                                       class="h-4 w-4 text-empresa-green border-gray-300 focus:ring-empresa-green flex-shrink-0">
                                                <span class="ml-4 text-gray-700">{{ choice.choice_label }}</span>
                                            </label>
                                        {% endif %}
                                    {% endfor %}
                                </div>
                                
                            {% elif field.field.widget.template_name == 'django/forms/widgets/textarea.html' %}
                                {{ field|add_class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-empresa-green focus:border-transparent resize-vertical"|attr:"rows:4" }}
                                
                            {% else %}
                                {{ field|add_class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-empresa-green focus:border-transparent" }}
                            {% endif %}
                        </div>

                        <!-- Errores -->
                        {% if field.errors %}
                            <div class="mt-3">
                                {% for error in field.errors %}
                                    <p class="text-red-600 text-sm flex items-start space-x-2">
                                        <svg class="w-3 h-3 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
                                        </svg>
                                        <span>{{ error }}</span>
                                    </p>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>

                <!-- Botón de envío -->
                <div class="mt-10 pt-6 border-t border-gray-100">
                    <button type="submit" class="w-full bg-empresa-green text-white font-semibold py-4 px-6 rounded-lg hover:bg-opacity-90 transition-all duration-200 shadow-sm hover:shadow-md">
                        Enviar Encuesta
                    </button>
                    <p class="text-center text-gray-500 text-sm mt-3">
                        Recibirá confirmación de su respuesta por correo electrónico
                    </p>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock content %}